
>本文记录重构时的一些要点、感悟、与思考。

# 背景

需要上线手机号验证码登录，老的 tpl + jquery 技术栈实现的登陆组件已经不再好维护迭代了，并且其中还含有大量的回调地狱，代码杂乱。

pc 客户端内嵌的登陆组件和 web 端登录 sdk 逻辑、样式上基本复用（除了登陆成功后注入 cookie 的逻辑不一致），同时 H5 登录、小程序登录、hippy 登录用到的登录登出接口逻辑是可以复用的，考虑到未来可能会把多端登录都收敛到一个 sdk 中，**因此搭建 monorepo** ，便于登陆相关逻辑、登录框 ui 样式、cookie 同步注入逻辑一起复用。详见： [多端登录同一项目](多端登录同一项目（uni）.md)

# 技术方案设计

按 UnionLogin 类、代码目录、各核心功能模块进行拆分讲解

# 从 0 到 1 

## 1. 统计老登陆组件在用的各业务方

首先，我们可以通过鹰眼流水统计 refer 来源，找到是哪些域名和站点在使用登录组件

那么，如何知道各业务方分别调用了那些登陆组件暴露的方法呢？
## 2. svelte 文档上手，技术选型，为啥用它？
## 3. monorepo 搭建、部署流水线搭建
## 4. 开发 - 踩坑 - 开发
## 5. 编译打包 （rollup、vite 的使用）
## 6. npm 包发布、monorepo 包管理工具
## 7. 推动各业务方升级接入新登录sdk
## 8. 灰度放量方案
## 9. 关键流程日志上报、埋点上报



# 总结


